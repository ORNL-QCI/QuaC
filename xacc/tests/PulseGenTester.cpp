
#include <vector>
#include <complex>
#include <gtest/gtest.h>
#include "PulseGen.hpp"

namespace
{
    const std::complex<double> I{0.0, 1.0};
    const std::vector<std::complex<double>> REF_DRAG_PULSE{
        0.00191388 - 1.12653645e-04 * I, 0.00320481 - 1.88049039e-04 * I,
        0.0045078 - 2.63674423e-04 * I, 0.00582291 - 3.39525951e-04 * I,
        0.00715017 - 4.15599691e-04 * I, 0.00848964 - 4.91891627e-04 * I,
        0.00984137 - 5.68397660e-04 * I, 0.01120539 - 6.45113608e-04 * I,
        0.01258175 - 7.22035201e-04 * I, 0.0139705 - 7.99158086e-04 * I,
        0.01537167 - 8.76477827e-04 * I, 0.01678531 - 9.53989899e-04 * I,
        0.01821146 - 1.03168970e-03 * I, 0.01965015 - 1.10957252e-03 * I,
        0.02110143 - 1.18763360e-03 * I, 0.02256534 - 1.26586806e-03 * I,
        0.0240419 - 1.34427096e-03 * I, 0.02553116 - 1.42283726e-03 * I,
        0.02703315 - 1.50156184e-03 * I, 0.0285479 - 1.58043949e-03 * I,
        0.03007544 - 1.65946492e-03 * I, 0.0316158 - 1.73863275e-03 * I,
        0.03316902 - 1.81793751e-03 * I, 0.03473513 - 1.89737365e-03 * I,
        0.03631414 - 1.97693555e-03 * I, 0.03790609 - 2.05661747e-03 * I,
        0.03951099 - 2.13641361e-03 * I, 0.04112888 - 2.21631808e-03 * I,
        0.04275978 - 2.29632490e-03 * I, 0.04440371 - 2.37642802e-03 * I,
        0.04606068 - 2.45662127e-03 * I, 0.04773072 - 2.53689845e-03 * I,
        0.04941384 - 2.61725322e-03 * I, 0.05111006 - 2.69767920e-03 * I,
        0.05281939 - 2.77816990e-03 * I, 0.05454185 - 2.85871876e-03 * I,
        0.05627745 - 2.93931912e-03 * I, 0.05802619 - 3.01996427e-03 * I,
        0.05978809 - 3.10064738e-03 * I, 0.06156316 - 3.18136157e-03 * I,
        0.06335139 - 3.26209986e-03 * I, 0.0651528 - 3.34285520e-03 * I,
        0.06696739 - 3.42362045e-03 * I, 0.06879515 - 3.50438839e-03 * I,
        0.07063609 - 3.58515174e-03 * I, 0.07249021 - 3.66590312e-03 * I,
        0.0743575 - 3.74663508e-03 * I, 0.07623796 - 3.82734009e-03 * I,
        0.07813158 - 3.90801055e-03 * I, 0.08003836 - 3.98863878e-03 * I,
        0.08195827 - 4.06921703e-03 * I, 0.08389132 - 4.14973746e-03 * I,
        0.08583749 - 4.23019217e-03 * I, 0.08779677 - 4.31057319e-03 * I,
        0.08976913 - 4.39087246e-03 * I, 0.09175456 - 4.47108187e-03 * I,
        0.09375304 - 4.55119323e-03 * I, 0.09576455 - 4.63119827e-03 * I,
        0.09778907 - 4.71108867e-03 * I, 0.09982656 - 4.79085603e-03 * I,
        0.10187701 - 4.87049188e-03 * I, 0.10394038 - 4.94998770e-03 * I,
        0.10601664 - 5.02933490e-03 * I, 0.10810576 - 5.10852480e-03 * I,
        0.11020772 - 5.18754870e-03 * I, 0.11232246 - 5.26639781e-03 * I,
        0.11444995 - 5.34506329e-03 * I, 0.11659015 - 5.42353622e-03 * I,
        0.11874303 - 5.50180766e-03 * I, 0.12090853 - 5.57986858e-03 * I,
        0.12308662 - 5.65770991e-03 * I, 0.12527724 - 5.73532252e-03 * I,
        0.12748034 - 5.81269722e-03 * I, 0.12969588 - 5.88982478e-03 * I,
        0.13192379 - 5.96669592e-03 * I, 0.13416403 - 6.04330129e-03 * I,
        0.13641654 - 6.11963152e-03 * I, 0.13868125 - 6.19567717e-03 * I,
        0.14095811 - 6.27142877e-03 * I, 0.14324706 - 6.34687680e-03 * I,
        0.14554802 - 6.42201169e-03 * I, 0.14786093 - 6.49682384e-03 * I,
        0.15018572 - 6.57130361e-03 * I, 0.15252232 - 6.64544132e-03 * I,
        0.15487065 - 6.71922724e-03 * I, 0.15723065 - 6.79265163e-03 * I,
        0.15960223 - 6.86570469e-03 * I, 0.16198531 - 6.93837661e-03 * I,
        0.16437981 - 7.01065755e-03 * I, 0.16678565 - 7.08253761e-03 * I,
        0.16920274 - 7.15400691e-03 * I, 0.17163099 - 7.22505551e-03 * I,
        0.17407031 - 7.29567346e-03 * I, 0.17652061 - 7.36585078e-03 * I,
        0.1789818 - 7.43557749e-03 * I, 0.18145378 - 7.50484357e-03 * I,
        0.18393645 - 7.57363898e-03 * I, 0.1864297 - 7.64195370e-03 * I,
        0.18893344 - 7.70977766e-03 * I, 0.19144757 - 7.77710080e-03 * I,
        0.19397196 - 7.84391304e-03 * I, 0.19650653 - 7.91020431e-03 * I,
        0.19905114 - 7.97596451e-03 * I, 0.20160569 - 8.04118355e-03 * I,
        0.20417007 - 8.10585135e-03 * I, 0.20674415 - 8.16995781e-03 * I,
        0.20932782 - 8.23349284e-03 * I, 0.21192095 - 8.29644637e-03 * I,
        0.21452342 - 8.35880832e-03 * I, 0.2171351 - 8.42056861e-03 * I,
        0.21975587 - 8.48171720e-03 * I, 0.22238558 - 8.54224404e-03 * I,
        0.22502412 - 8.60213909e-03 * I, 0.22767135 - 8.66139236e-03 * I,
        0.23032712 - 8.71999385e-03 * I, 0.23299129 - 8.77793358e-03 * I,
        0.23566374 - 8.83520162e-03 * I, 0.23834431 - 8.89178803e-03 * I,
        0.24103286 - 8.94768293e-03 * I, 0.24372924 - 9.00287645e-03 * I,
        0.2464333 - 9.05735876e-03 * I, 0.24914488 - 9.11112005e-03 * I,
        0.25186385 - 9.16415058e-03 * I, 0.25459003 - 9.21644062e-03 * I,
        0.25732327 - 9.26798048e-03 * I, 0.26006342 - 9.31876052e-03 * I,
        0.2628103 - 9.36877116e-03 * I, 0.26556375 - 9.41800285e-03 * I,
        0.26832362 - 9.46644609e-03 * I, 0.27108973 - 9.51409143e-03 * I,
        0.2738619 - 9.56092950e-03 * I, 0.27663997 - 9.60695094e-03 * I,
        0.27942377 - 9.65214650e-03 * I, 0.28221312 - 9.69650695e-03 * I,
        0.28500783 - 9.74002314e-03 * I, 0.28780773 - 9.78268599e-03 * I,
        0.29061265 - 9.82448649e-03 * I, 0.29342238 - 9.86541568e-03 * I,
        0.29623675 - 9.90546469e-03 * I, 0.29905558 - 9.94462472e-03 * I,
        0.30187866 - 9.98288704e-03 * I, 0.30470582 - 1.00202430e-02 * I,
        0.30753685 - 1.00566841e-02 * I, 0.31037157 - 1.00922017e-02 * I,
        0.31320977 - 1.01267876e-02 * I, 0.31605126 - 1.01604334e-02 * I,
        0.31889583 - 1.01931309e-02 * I, 0.32174329 - 1.02248719e-02 * I,
        0.32459343 - 1.02556485e-02 * I, 0.32744604 - 1.02854527e-02 * I,
        0.33030093 - 1.03142767e-02 * I, 0.33315787 - 1.03421127e-02 * I,
        0.33601666 - 1.03689531e-02 * I, 0.3388771 - 1.03947905e-02 * I,
        0.34173895 - 1.04196173e-02 * I, 0.34460202 - 1.04434262e-02 * I,
        0.34746608 - 1.04662102e-02 * I, 0.35033091 - 1.04879621e-02 * I,
        0.3531963 - 1.05086749e-02 * I, 0.35606202 - 1.05283418e-02 * I,
        0.35892786 - 1.05469561e-02 * I, 0.36179358 - 1.05645111e-02 * I,
        0.36465896 - 1.05810005e-02 * I, 0.36752378 - 1.05964179e-02 * I,
        0.37038781 - 1.06107569e-02 * I, 0.37325082 - 1.06240116e-02 * I,
        0.37611258 - 1.06361761e-02 * I, 0.37897285 - 1.06472444e-02 * I,
        0.3818314 - 1.06572108e-02 * I, 0.384688 - 1.06660700e-02 * I,
        0.38754242 - 1.06738163e-02 * I, 0.39039442 - 1.06804447e-02 * I,
        0.39324375 - 1.06859499e-02 * I, 0.39609019 - 1.06903270e-02 * I,
        0.39893348 - 1.06935712e-02 * I, 0.4017734 - 1.06956777e-02 * I,
        0.40460969 - 1.06966422e-02 * I, 0.40744213 - 1.06964601e-02 * I,
        0.41027045 - 1.06951273e-02 * I, 0.41309442 - 1.06926398e-02 * I,
        0.4159138 - 1.06889936e-02 * I, 0.41872833 - 1.06841850e-02 * I,
        0.42153777 - 1.06782105e-02 * I, 0.42434187 - 1.06710665e-02 * I,
        0.42714039 - 1.06627499e-02 * I, 0.42993308 - 1.06532576e-02 * I,
        0.43271968 - 1.06425866e-02 * I, 0.43549994 - 1.06307343e-02 * I,
        0.43827362 - 1.06176980e-02 * I, 0.44104046 - 1.06034753e-02 * I,
        0.44380022 - 1.05880641e-02 * I, 0.44655263 - 1.05714622e-02 * I,
        0.44929745 - 1.05536678e-02 * I, 0.45203442 - 1.05346792e-02 * I,
        0.4547633 - 1.05144949e-02 * I, 0.45748382 - 1.04931135e-02 * I,
        0.46019573 - 1.04705338e-02 * I, 0.46289878 - 1.04467550e-02 * I,
        0.46559272 - 1.04217761e-02 * I, 0.46827728 - 1.03955966e-02 * I,
        0.47095222 - 1.03682160e-02 * I, 0.47361728 - 1.03396341e-02 * I,
        0.4762722 - 1.03098509e-02 * I, 0.47891674 - 1.02788665e-02 * I,
        0.48155063 - 1.02466812e-02 * I, 0.48417363 - 1.02132955e-02 * I,
        0.48678547 - 1.01787102e-02 * I, 0.4893859 - 1.01429260e-02 * I,
        0.49197467 - 1.01059442e-02 * I, 0.49455153 - 1.00677660e-02 * I,
        0.49711622 - 1.00283928e-02 * I, 0.49966849 - 9.98782631e-03 * I,
        0.50220808 - 9.94606842e-03 * I, 0.50473474 - 9.90312115e-03 * I,
        0.50724823 - 9.85898677e-03 * I, 0.50974829 - 9.81366770e-03 * I,
        0.51223466 - 9.76716660e-03 * I, 0.5147071 - 9.71948629e-03 * I,
        0.51716537 - 9.67062980e-03 * I, 0.5196092 - 9.62060037e-03 * I,
        0.52203835 - 9.56940141e-03 * I, 0.52445258 - 9.51703654e-03 * I,
        0.52685163 - 9.46350958e-03 * I, 0.52923526 - 9.40882455e-03 * I,
        0.53160323 - 9.35298565e-03 * I, 0.53395529 - 9.29599729e-03 * I,
        0.5362912 - 9.23786407e-03 * I, 0.53861072 - 9.17859079e-03 * I,
        0.5409136 - 9.11818245e-03 * I, 0.5431996 - 9.05664423e-03 * I,
        0.5454685 - 8.99398152e-03 * I, 0.54772003 - 8.93019991e-03 * I,
        0.54995398 - 8.86530516e-03 * I, 0.55217011 - 8.79930326e-03 * I,
        0.55436818 - 8.73220035e-03 * I, 0.55654796 - 8.66400281e-03 * I,
        0.55870921 - 8.59471717e-03 * I, 0.56085171 - 8.52435018e-03 * I,
        0.56297523 - 8.45290877e-03 * I, 0.56507955 - 8.38040007e-03 * I,
        0.56716443 - 8.30683139e-03 * I, 0.56922965 - 8.23221023e-03 * I,
        0.57127499 - 8.15654428e-03 * I, 0.57330023 - 8.07984142e-03 * I,
        0.57530516 - 8.00210970e-03 * I, 0.57728954 - 7.92335739e-03 * I,
        0.57925317 - 7.84359290e-03 * I, 0.58119584 - 7.76282486e-03 * I,
        0.58311733 - 7.68106207e-03 * I, 0.58501743 - 7.59831349e-03 * I,
        0.58689594 - 7.51458829e-03 * I, 0.58875264 - 7.42989581e-03 * I,
        0.59058734 - 7.34424554e-03 * I, 0.59239983 - 7.25764719e-03 * I,
        0.59418991 - 7.17011062e-03 * I, 0.59595738 - 7.08164584e-03 * I,
        0.59770206 - 6.99226308e-03 * I, 0.59942374 - 6.90197270e-03 * I,
        0.60112223 - 6.81078525e-03 * I, 0.60279734 - 6.71871143e-03 * I,
        0.6044489 - 6.62576211e-03 * I, 0.6060767 - 6.53194834e-03 * I,
        0.60768058 - 6.43728129e-03 * I, 0.60926035 - 6.34177234e-03 * I,
        0.61081583 - 6.24543299e-03 * I, 0.61234686 - 6.14827491e-03 * I,
        0.61385324 - 6.05030992e-03 * I, 0.61533483 - 5.95154998e-03 * I,
        0.61679145 - 5.85200723e-03 * I, 0.61822293 - 5.75169393e-03 * I,
        0.61962911 - 5.65062250e-03 * I, 0.62100984 - 5.54880549e-03 * I,
        0.62236495 - 5.44625560e-03 * I, 0.6236943 - 5.34298566e-03 * I,
        0.62499772 - 5.23900865e-03 * I, 0.62627508 - 5.13433768e-03 * I,
        0.62752623 - 5.02898599e-03 * I, 0.62875102 - 4.92296694e-03 * I,
        0.62994932 - 4.81629403e-03 * I, 0.63112098 - 4.70898087e-03 * I,
        0.63226588 - 4.60104123e-03 * I, 0.63338388 - 4.49248894e-03 * I,
        0.63447485 - 4.38333800e-03 * I, 0.63553866 - 4.27360250e-03 * I,
        0.63657521 - 4.16329664e-03 * I, 0.63758435 - 4.05243474e-03 * I,
        0.63856599 - 3.94103123e-03 * I, 0.63952001 - 3.82910062e-03 * I,
        0.64044628 - 3.71665755e-03 * I, 0.64134472 - 3.60371674e-03 * I,
        0.64221521 - 3.49029302e-03 * I, 0.64305766 - 3.37640130e-03 * I,
        0.64387196 - 3.26205659e-03 * I, 0.64465803 - 3.14727398e-03 * I,
        0.64541576 - 3.03206865e-03 * I, 0.64614508 - 2.91645586e-03 * I,
        0.64684589 - 2.80045094e-03 * I, 0.64751812 - 2.68406933e-03 * I,
        0.64816169 - 2.56732649e-03 * I, 0.64877652 - 2.45023799e-03 * I,
        0.64936255 - 2.33281946e-03 * I, 0.64991969 - 2.21508659e-03 * I,
        0.6504479 - 2.09705512e-03 * I, 0.6509471 - 1.97874086e-03 * I,
        0.65141724 - 1.86015968e-03 * I, 0.65185826 - 1.74132749e-03 * I,
        0.65227011 - 1.62226026e-03 * I, 0.65265275 - 1.50297400e-03 * I,
        0.65300613 - 1.38348476e-03 * I, 0.6533302 - 1.26380863e-03 * I,
        0.65362493 - 1.14396174e-03 * I, 0.65389029 - 1.02396025e-03 * I,
        0.65412624 - 9.03820360e-04 * I, 0.65433276 - 7.83558284e-04 * I,
        0.65450982 - 6.63190265e-04 * I, 0.65465741 - 5.42732568e-04 * I,
        0.65477549 - 4.22201473e-04 * I, 0.65486407 - 3.01613277e-04 * I,
        0.65492313 - 1.80984287e-04 * I, 0.65495266 - 6.03308157e-05 * I,
        0.65495266 + 6.03308157e-05 * I, 0.65492313 + 1.80984287e-04 * I,
        0.65486407 + 3.01613277e-04 * I, 0.65477549 + 4.22201473e-04 * I,
        0.65465741 + 5.42732568e-04 * I, 0.65450982 + 6.63190265e-04 * I,
        0.65433276 + 7.83558284e-04 * I, 0.65412624 + 9.03820360e-04 * I,
        0.65389029 + 1.02396025e-03 * I, 0.65362493 + 1.14396174e-03 * I,
        0.6533302 + 1.26380863e-03 * I, 0.65300613 + 1.38348476e-03 * I,
        0.65265275 + 1.50297400e-03 * I, 0.65227011 + 1.62226026e-03 * I,
        0.65185826 + 1.74132749e-03 * I, 0.65141724 + 1.86015968e-03 * I,
        0.6509471 + 1.97874086e-03 * I, 0.6504479 + 2.09705512e-03 * I,
        0.64991969 + 2.21508659e-03 * I, 0.64936255 + 2.33281946e-03 * I,
        0.64877652 + 2.45023799e-03 * I, 0.64816169 + 2.56732649e-03 * I,
        0.64751812 + 2.68406933e-03 * I, 0.64684589 + 2.80045094e-03 * I,
        0.64614508 + 2.91645586e-03 * I, 0.64541576 + 3.03206865e-03 * I,
        0.64465803 + 3.14727398e-03 * I, 0.64387196 + 3.26205659e-03 * I,
        0.64305766 + 3.37640130e-03 * I, 0.64221521 + 3.49029302e-03 * I,
        0.64134472 + 3.60371674e-03 * I, 0.64044628 + 3.71665755e-03 * I,
        0.63952001 + 3.82910062e-03 * I, 0.63856599 + 3.94103123e-03 * I,
        0.63758435 + 4.05243474e-03 * I, 0.63657521 + 4.16329664e-03 * I,
        0.63553866 + 4.27360250e-03 * I, 0.63447485 + 4.38333800e-03 * I,
        0.63338388 + 4.49248894e-03 * I, 0.63226588 + 4.60104123e-03 * I,
        0.63112098 + 4.70898087e-03 * I, 0.62994932 + 4.81629403e-03 * I,
        0.62875102 + 4.92296694e-03 * I, 0.62752623 + 5.02898599e-03 * I,
        0.62627508 + 5.13433768e-03 * I, 0.62499772 + 5.23900865e-03 * I,
        0.6236943 + 5.34298566e-03 * I, 0.62236495 + 5.44625560e-03 * I,
        0.62100984 + 5.54880549e-03 * I, 0.61962911 + 5.65062250e-03 * I,
        0.61822293 + 5.75169393e-03 * I, 0.61679145 + 5.85200723e-03 * I,
        0.61533483 + 5.95154998e-03 * I, 0.61385324 + 6.05030992e-03 * I,
        0.61234686 + 6.14827491e-03 * I, 0.61081583 + 6.24543299e-03 * I,
        0.60926035 + 6.34177234e-03 * I, 0.60768058 + 6.43728129e-03 * I,
        0.6060767 + 6.53194834e-03 * I, 0.6044489 + 6.62576211e-03 * I,
        0.60279734 + 6.71871143e-03 * I, 0.60112223 + 6.81078525e-03 * I,
        0.59942374 + 6.90197270e-03 * I, 0.59770206 + 6.99226308e-03 * I,
        0.59595738 + 7.08164584e-03 * I, 0.59418991 + 7.17011062e-03 * I,
        0.59239983 + 7.25764719e-03 * I, 0.59058734 + 7.34424554e-03 * I,
        0.58875264 + 7.42989581e-03 * I, 0.58689594 + 7.51458829e-03 * I,
        0.58501743 + 7.59831349e-03 * I, 0.58311733 + 7.68106207e-03 * I,
        0.58119584 + 7.76282486e-03 * I, 0.57925317 + 7.84359290e-03 * I,
        0.57728954 + 7.92335739e-03 * I, 0.57530516 + 8.00210970e-03 * I,
        0.57330023 + 8.07984142e-03 * I, 0.57127499 + 8.15654428e-03 * I,
        0.56922965 + 8.23221023e-03 * I, 0.56716443 + 8.30683139e-03 * I,
        0.56507955 + 8.38040007e-03 * I, 0.56297523 + 8.45290877e-03 * I,
        0.56085171 + 8.52435018e-03 * I, 0.55870921 + 8.59471717e-03 * I,
        0.55654796 + 8.66400281e-03 * I, 0.55436818 + 8.73220035e-03 * I,
        0.55217011 + 8.79930326e-03 * I, 0.54995398 + 8.86530516e-03 * I,
        0.54772003 + 8.93019991e-03 * I, 0.5454685 + 8.99398152e-03 * I,
        0.5431996 + 9.05664423e-03 * I, 0.5409136 + 9.11818245e-03 * I,
        0.53861072 + 9.17859079e-03 * I, 0.5362912 + 9.23786407e-03 * I,
        0.53395529 + 9.29599729e-03 * I, 0.53160323 + 9.35298565e-03 * I,
        0.52923526 + 9.40882455e-03 * I, 0.52685163 + 9.46350958e-03 * I,
        0.52445258 + 9.51703654e-03 * I, 0.52203835 + 9.56940141e-03 * I,
        0.5196092 + 9.62060037e-03 * I, 0.51716537 + 9.67062980e-03 * I,
        0.5147071 + 9.71948629e-03 * I, 0.51223466 + 9.76716660e-03 * I,
        0.50974829 + 9.81366770e-03 * I, 0.50724823 + 9.85898677e-03 * I,
        0.50473474 + 9.90312115e-03 * I, 0.50220808 + 9.94606842e-03 * I,
        0.49966849 + 9.98782631e-03 * I, 0.49711622 + 1.00283928e-02 * I,
        0.49455153 + 1.00677660e-02 * I, 0.49197467 + 1.01059442e-02 * I,
        0.4893859 + 1.01429260e-02 * I, 0.48678547 + 1.01787102e-02 * I,
        0.48417363 + 1.02132955e-02 * I, 0.48155063 + 1.02466812e-02 * I,
        0.47891674 + 1.02788665e-02 * I, 0.4762722 + 1.03098509e-02 * I,
        0.47361728 + 1.03396341e-02 * I, 0.47095222 + 1.03682160e-02 * I,
        0.46827728 + 1.03955966e-02 * I, 0.46559272 + 1.04217761e-02 * I,
        0.46289878 + 1.04467550e-02 * I, 0.46019573 + 1.04705338e-02 * I,
        0.45748382 + 1.04931135e-02 * I, 0.4547633 + 1.05144949e-02 * I,
        0.45203442 + 1.05346792e-02 * I, 0.44929745 + 1.05536678e-02 * I,
        0.44655263 + 1.05714622e-02 * I, 0.44380022 + 1.05880641e-02 * I,
        0.44104046 + 1.06034753e-02 * I, 0.43827362 + 1.06176980e-02 * I,
        0.43549994 + 1.06307343e-02 * I, 0.43271968 + 1.06425866e-02 * I,
        0.42993308 + 1.06532576e-02 * I, 0.42714039 + 1.06627499e-02 * I,
        0.42434187 + 1.06710665e-02 * I, 0.42153777 + 1.06782105e-02 * I,
        0.41872833 + 1.06841850e-02 * I, 0.4159138 + 1.06889936e-02 * I,
        0.41309442 + 1.06926398e-02 * I, 0.41027045 + 1.06951273e-02 * I,
        0.40744213 + 1.06964601e-02 * I, 0.40460969 + 1.06966422e-02 * I,
        0.4017734 + 1.06956777e-02 * I, 0.39893348 + 1.06935712e-02 * I,
        0.39609019 + 1.06903270e-02 * I, 0.39324375 + 1.06859499e-02 * I,
        0.39039442 + 1.06804447e-02 * I, 0.38754242 + 1.06738163e-02 * I,
        0.384688 + 1.06660700e-02 * I, 0.3818314 + 1.06572108e-02 * I,
        0.37897285 + 1.06472444e-02 * I, 0.37611258 + 1.06361761e-02 * I,
        0.37325082 + 1.06240116e-02 * I, 0.37038781 + 1.06107569e-02 * I,
        0.36752378 + 1.05964179e-02 * I, 0.36465896 + 1.05810005e-02 * I,
        0.36179358 + 1.05645111e-02 * I, 0.35892786 + 1.05469561e-02 * I,
        0.35606202 + 1.05283418e-02 * I, 0.3531963 + 1.05086749e-02 * I,
        0.35033091 + 1.04879621e-02 * I, 0.34746608 + 1.04662102e-02 * I,
        0.34460202 + 1.04434262e-02 * I, 0.34173895 + 1.04196173e-02 * I,
        0.3388771 + 1.03947905e-02 * I, 0.33601666 + 1.03689531e-02 * I,
        0.33315787 + 1.03421127e-02 * I, 0.33030093 + 1.03142767e-02 * I,
        0.32744604 + 1.02854527e-02 * I, 0.32459343 + 1.02556485e-02 * I,
        0.32174329 + 1.02248719e-02 * I, 0.31889583 + 1.01931309e-02 * I,
        0.31605126 + 1.01604334e-02 * I, 0.31320977 + 1.01267876e-02 * I,
        0.31037157 + 1.00922017e-02 * I, 0.30753685 + 1.00566841e-02 * I,
        0.30470582 + 1.00202430e-02 * I, 0.30187866 + 9.98288704e-03 * I,
        0.29905558 + 9.94462472e-03 * I, 0.29623675 + 9.90546469e-03 * I,
        0.29342238 + 9.86541568e-03 * I, 0.29061265 + 9.82448649e-03 * I,
        0.28780773 + 9.78268599e-03 * I, 0.28500783 + 9.74002314e-03 * I,
        0.28221312 + 9.69650695e-03 * I, 0.27942377 + 9.65214650e-03 * I,
        0.27663997 + 9.60695094e-03 * I, 0.2738619 + 9.56092950e-03 * I,
        0.27108973 + 9.51409143e-03 * I, 0.26832362 + 9.46644609e-03 * I,
        0.26556375 + 9.41800285e-03 * I, 0.2628103 + 9.36877116e-03 * I,
        0.26006342 + 9.31876052e-03 * I, 0.25732327 + 9.26798048e-03 * I,
        0.25459003 + 9.21644062e-03 * I, 0.25186385 + 9.16415058e-03 * I,
        0.24914488 + 9.11112005e-03 * I, 0.2464333 + 9.05735876e-03 * I,
        0.24372924 + 9.00287645e-03 * I, 0.24103286 + 8.94768293e-03 * I,
        0.23834431 + 8.89178803e-03 * I, 0.23566374 + 8.83520162e-03 * I,
        0.23299129 + 8.77793358e-03 * I, 0.23032712 + 8.71999385e-03 * I,
        0.22767135 + 8.66139236e-03 * I, 0.22502412 + 8.60213909e-03 * I,
        0.22238558 + 8.54224404e-03 * I, 0.21975587 + 8.48171720e-03 * I,
        0.2171351 + 8.42056861e-03 * I, 0.21452342 + 8.35880832e-03 * I,
        0.21192095 + 8.29644637e-03 * I, 0.20932782 + 8.23349284e-03 * I,
        0.20674415 + 8.16995781e-03 * I, 0.20417007 + 8.10585135e-03 * I,
        0.20160569 + 8.04118355e-03 * I, 0.19905114 + 7.97596451e-03 * I,
        0.19650653 + 7.91020431e-03 * I, 0.19397196 + 7.84391304e-03 * I,
        0.19144757 + 7.77710080e-03 * I, 0.18893344 + 7.70977766e-03 * I,
        0.1864297 + 7.64195370e-03 * I, 0.18393645 + 7.57363898e-03 * I,
        0.18145378 + 7.50484357e-03 * I, 0.1789818 + 7.43557749e-03 * I,
        0.17652061 + 7.36585078e-03 * I, 0.17407031 + 7.29567346e-03 * I,
        0.17163099 + 7.22505551e-03 * I, 0.16920274 + 7.15400691e-03 * I,
        0.16678565 + 7.08253761e-03 * I, 0.16437981 + 7.01065755e-03 * I,
        0.16198531 + 6.93837661e-03 * I, 0.15960223 + 6.86570469e-03 * I,
        0.15723065 + 6.79265163e-03 * I, 0.15487065 + 6.71922724e-03 * I,
        0.15252232 + 6.64544132e-03 * I, 0.15018572 + 6.57130361e-03 * I,
        0.14786093 + 6.49682384e-03 * I, 0.14554802 + 6.42201169e-03 * I,
        0.14324706 + 6.34687680e-03 * I, 0.14095811 + 6.27142877e-03 * I,
        0.13868125 + 6.19567717e-03 * I, 0.13641654 + 6.11963152e-03 * I,
        0.13416403 + 6.04330129e-03 * I, 0.13192379 + 5.96669592e-03 * I,
        0.12969588 + 5.88982478e-03 * I, 0.12748034 + 5.81269722e-03 * I,
        0.12527724 + 5.73532252e-03 * I, 0.12308662 + 5.65770991e-03 * I,
        0.12090853 + 5.57986858e-03 * I, 0.11874303 + 5.50180766e-03 * I,
        0.11659015 + 5.42353622e-03 * I, 0.11444995 + 5.34506329e-03 * I,
        0.11232246 + 5.26639781e-03 * I, 0.11020772 + 5.18754870e-03 * I,
        0.10810576 + 5.10852480e-03 * I, 0.10601664 + 5.02933490e-03 * I,
        0.10394038 + 4.94998770e-03 * I, 0.10187701 + 4.87049188e-03 * I,
        0.09982656 + 4.79085603e-03 * I, 0.09778907 + 4.71108867e-03 * I,
        0.09576455 + 4.63119827e-03 * I, 0.09375304 + 4.55119323e-03 * I,
        0.09175456 + 4.47108187e-03 * I, 0.08976913 + 4.39087246e-03 * I,
        0.08779677 + 4.31057319e-03 * I, 0.08583749 + 4.23019217e-03 * I,
        0.08389132 + 4.14973746e-03 * I, 0.08195827 + 4.06921703e-03 * I,
        0.08003836 + 3.98863878e-03 * I, 0.07813158 + 3.90801055e-03 * I,
        0.07623796 + 3.82734009e-03 * I, 0.0743575 + 3.74663508e-03 * I,
        0.07249021 + 3.66590312e-03 * I, 0.07063609 + 3.58515174e-03 * I,
        0.06879515 + 3.50438839e-03 * I, 0.06696739 + 3.42362045e-03 * I,
        0.0651528 + 3.34285520e-03 * I, 0.06335139 + 3.26209986e-03 * I,
        0.06156316 + 3.18136157e-03 * I, 0.05978809 + 3.10064738e-03 * I,
        0.05802619 + 3.01996427e-03 * I, 0.05627745 + 2.93931912e-03 * I,
        0.05454185 + 2.85871876e-03 * I, 0.05281939 + 2.77816990e-03 * I,
        0.05111006 + 2.69767920e-03 * I, 0.04941384 + 2.61725322e-03 * I,
        0.04773072 + 2.53689845e-03 * I, 0.04606068 + 2.45662127e-03 * I,
        0.04440371 + 2.37642802e-03 * I, 0.04275978 + 2.29632490e-03 * I,
        0.04112888 + 2.21631808e-03 * I, 0.03951099 + 2.13641361e-03 * I,
        0.03790609 + 2.05661747e-03 * I, 0.03631414 + 1.97693555e-03 * I,
        0.03473513 + 1.89737365e-03 * I, 0.03316902 + 1.81793751e-03 * I,
        0.0316158 + 1.73863275e-03 * I, 0.03007544 + 1.65946492e-03 * I,
        0.0285479 + 1.58043949e-03 * I, 0.02703315 + 1.50156184e-03 * I,
        0.02553116 + 1.42283726e-03 * I, 0.0240419 + 1.34427096e-03 * I,
        0.02256534 + 1.26586806e-03 * I, 0.02110143 + 1.18763360e-03 * I,
        0.01965015 + 1.10957252e-03 * I, 0.01821146 + 1.03168970e-03 * I,
        0.01678531 + 9.53989899e-04 * I, 0.01537167 + 8.76477827e-04 * I,
        0.0139705 + 7.99158086e-04 * I, 0.01258175 + 7.22035201e-04 * I,
        0.01120539 + 6.45113608e-04 * I, 0.00984137 + 5.68397660e-04 * I,
        0.00848964 + 4.91891627e-04 * I, 0.00715017 + 4.15599691e-04 * I,
        0.00582291 + 3.39525951e-04 * I, 0.0045078 + 2.63674423e-04 * I,
        0.00320481 + 1.88049039e-04 * I, 0.00191388 + 1.12653645e-04 * I};

    const std::vector<std::complex<double>> REF_GAUSSIAN_PULSE{
        0.00191388 + 0.0 * I, 0.00320481 + 0.0 * I, 0.0045078 + 0.0 * I, 0.00582291 + 0.0 * I,
        0.00715017 + 0.0 * I, 0.00848964 + 0.0 * I, 0.00984137 + 0.0 * I, 0.01120539 + 0.0 * I,
        0.01258175 + 0.0 * I, 0.0139705 + 0.0 * I, 0.01537167 + 0.0 * I, 0.01678531 + 0.0 * I,
        0.01821146 + 0.0 * I, 0.01965015 + 0.0 * I, 0.02110143 + 0.0 * I, 0.02256534 + 0.0 * I,
        0.0240419 + 0.0 * I, 0.02553116 + 0.0 * I, 0.02703315 + 0.0 * I, 0.0285479 + 0.0 * I,
        0.03007544 + 0.0 * I, 0.0316158 + 0.0 * I, 0.03316902 + 0.0 * I, 0.03473513 + 0.0 * I,
        0.03631414 + 0.0 * I, 0.03790609 + 0.0 * I, 0.03951099 + 0.0 * I, 0.04112888 + 0.0 * I,
        0.04275978 + 0.0 * I, 0.04440371 + 0.0 * I, 0.04606068 + 0.0 * I, 0.04773072 + 0.0 * I,
        0.04941384 + 0.0 * I, 0.05111006 + 0.0 * I, 0.05281939 + 0.0 * I, 0.05454185 + 0.0 * I,
        0.05627745 + 0.0 * I, 0.05802619 + 0.0 * I, 0.05978809 + 0.0 * I, 0.06156316 + 0.0 * I,
        0.06335139 + 0.0 * I, 0.0651528 + 0.0 * I, 0.06696739 + 0.0 * I, 0.06879515 + 0.0 * I,
        0.07063609 + 0.0 * I, 0.07249021 + 0.0 * I, 0.0743575 + 0.0 * I, 0.07623796 + 0.0 * I,
        0.07813158 + 0.0 * I, 0.08003836 + 0.0 * I, 0.08195827 + 0.0 * I, 0.08389132 + 0.0 * I,
        0.08583749 + 0.0 * I, 0.08779677 + 0.0 * I, 0.08976913 + 0.0 * I, 0.09175456 + 0.0 * I,
        0.09375304 + 0.0 * I, 0.09576455 + 0.0 * I, 0.09778907 + 0.0 * I, 0.09982656 + 0.0 * I,
        0.10187701 + 0.0 * I, 0.10394038 + 0.0 * I, 0.10601664 + 0.0 * I, 0.10810576 + 0.0 * I,
        0.11020772 + 0.0 * I, 0.11232246 + 0.0 * I, 0.11444995 + 0.0 * I, 0.11659015 + 0.0 * I,
        0.11874303 + 0.0 * I, 0.12090853 + 0.0 * I, 0.12308662 + 0.0 * I, 0.12527724 + 0.0 * I,
        0.12748034 + 0.0 * I, 0.12969588 + 0.0 * I, 0.13192379 + 0.0 * I, 0.13416403 + 0.0 * I,
        0.13641654 + 0.0 * I, 0.13868125 + 0.0 * I, 0.14095811 + 0.0 * I, 0.14324706 + 0.0 * I,
        0.14554802 + 0.0 * I, 0.14786093 + 0.0 * I, 0.15018572 + 0.0 * I, 0.15252232 + 0.0 * I,
        0.15487065 + 0.0 * I, 0.15723065 + 0.0 * I, 0.15960223 + 0.0 * I, 0.16198531 + 0.0 * I,
        0.16437981 + 0.0 * I, 0.16678565 + 0.0 * I, 0.16920274 + 0.0 * I, 0.17163099 + 0.0 * I,
        0.17407031 + 0.0 * I, 0.17652061 + 0.0 * I, 0.1789818 + 0.0 * I, 0.18145378 + 0.0 * I,
        0.18393645 + 0.0 * I, 0.1864297 + 0.0 * I, 0.18893344 + 0.0 * I, 0.19144757 + 0.0 * I,
        0.19397196 + 0.0 * I, 0.19650653 + 0.0 * I, 0.19905114 + 0.0 * I, 0.20160569 + 0.0 * I,
        0.20417007 + 0.0 * I, 0.20674415 + 0.0 * I, 0.20932782 + 0.0 * I, 0.21192095 + 0.0 * I,
        0.21452342 + 0.0 * I, 0.2171351 + 0.0 * I, 0.21975587 + 0.0 * I, 0.22238558 + 0.0 * I,
        0.22502412 + 0.0 * I, 0.22767135 + 0.0 * I, 0.23032712 + 0.0 * I, 0.23299129 + 0.0 * I,
        0.23566374 + 0.0 * I, 0.23834431 + 0.0 * I, 0.24103286 + 0.0 * I, 0.24372924 + 0.0 * I,
        0.2464333 + 0.0 * I, 0.24914488 + 0.0 * I, 0.25186385 + 0.0 * I, 0.25459003 + 0.0 * I,
        0.25732327 + 0.0 * I, 0.26006342 + 0.0 * I, 0.2628103 + 0.0 * I, 0.26556375 + 0.0 * I,
        0.26832362 + 0.0 * I, 0.27108973 + 0.0 * I, 0.2738619 + 0.0 * I, 0.27663997 + 0.0 * I,
        0.27942377 + 0.0 * I, 0.28221312 + 0.0 * I, 0.28500783 + 0.0 * I, 0.28780773 + 0.0 * I,
        0.29061265 + 0.0 * I, 0.29342238 + 0.0 * I, 0.29623675 + 0.0 * I, 0.29905558 + 0.0 * I,
        0.30187866 + 0.0 * I, 0.30470582 + 0.0 * I, 0.30753685 + 0.0 * I, 0.31037157 + 0.0 * I,
        0.31320977 + 0.0 * I, 0.31605126 + 0.0 * I, 0.31889583 + 0.0 * I, 0.32174329 + 0.0 * I,
        0.32459343 + 0.0 * I, 0.32744604 + 0.0 * I, 0.33030093 + 0.0 * I, 0.33315787 + 0.0 * I,
        0.33601666 + 0.0 * I, 0.3388771 + 0.0 * I, 0.34173895 + 0.0 * I, 0.34460202 + 0.0 * I,
        0.34746608 + 0.0 * I, 0.35033091 + 0.0 * I, 0.3531963 + 0.0 * I, 0.35606202 + 0.0 * I,
        0.35892786 + 0.0 * I, 0.36179358 + 0.0 * I, 0.36465896 + 0.0 * I, 0.36752378 + 0.0 * I,
        0.37038781 + 0.0 * I, 0.37325082 + 0.0 * I, 0.37611258 + 0.0 * I, 0.37897285 + 0.0 * I,
        0.3818314 + 0.0 * I, 0.384688 + 0.0 * I, 0.38754242 + 0.0 * I, 0.39039442 + 0.0 * I,
        0.39324375 + 0.0 * I, 0.39609019 + 0.0 * I, 0.39893348 + 0.0 * I, 0.4017734 + 0.0 * I,
        0.40460969 + 0.0 * I, 0.40744213 + 0.0 * I, 0.41027045 + 0.0 * I, 0.41309442 + 0.0 * I,
        0.4159138 + 0.0 * I, 0.41872833 + 0.0 * I, 0.42153777 + 0.0 * I, 0.42434187 + 0.0 * I,
        0.42714039 + 0.0 * I, 0.42993308 + 0.0 * I, 0.43271968 + 0.0 * I, 0.43549994 + 0.0 * I,
        0.43827362 + 0.0 * I, 0.44104046 + 0.0 * I, 0.44380022 + 0.0 * I, 0.44655263 + 0.0 * I,
        0.44929745 + 0.0 * I, 0.45203442 + 0.0 * I, 0.4547633 + 0.0 * I, 0.45748382 + 0.0 * I,
        0.46019573 + 0.0 * I, 0.46289878 + 0.0 * I, 0.46559272 + 0.0 * I, 0.46827728 + 0.0 * I,
        0.47095222 + 0.0 * I, 0.47361728 + 0.0 * I, 0.4762722 + 0.0 * I, 0.47891674 + 0.0 * I,
        0.48155063 + 0.0 * I, 0.48417363 + 0.0 * I, 0.48678547 + 0.0 * I, 0.4893859 + 0.0 * I,
        0.49197467 + 0.0 * I, 0.49455153 + 0.0 * I, 0.49711622 + 0.0 * I, 0.49966849 + 0.0 * I,
        0.50220808 + 0.0 * I, 0.50473474 + 0.0 * I, 0.50724823 + 0.0 * I, 0.50974829 + 0.0 * I,
        0.51223466 + 0.0 * I, 0.5147071 + 0.0 * I, 0.51716537 + 0.0 * I, 0.5196092 + 0.0 * I,
        0.52203835 + 0.0 * I, 0.52445258 + 0.0 * I, 0.52685163 + 0.0 * I, 0.52923526 + 0.0 * I,
        0.53160323 + 0.0 * I, 0.53395529 + 0.0 * I, 0.5362912 + 0.0 * I, 0.53861072 + 0.0 * I,
        0.5409136 + 0.0 * I, 0.5431996 + 0.0 * I, 0.5454685 + 0.0 * I, 0.54772003 + 0.0 * I,
        0.54995398 + 0.0 * I, 0.55217011 + 0.0 * I, 0.55436818 + 0.0 * I, 0.55654796 + 0.0 * I,
        0.55870921 + 0.0 * I, 0.56085171 + 0.0 * I, 0.56297523 + 0.0 * I, 0.56507955 + 0.0 * I,
        0.56716443 + 0.0 * I, 0.56922965 + 0.0 * I, 0.57127499 + 0.0 * I, 0.57330023 + 0.0 * I,
        0.57530516 + 0.0 * I, 0.57728954 + 0.0 * I, 0.57925317 + 0.0 * I, 0.58119584 + 0.0 * I,
        0.58311733 + 0.0 * I, 0.58501743 + 0.0 * I, 0.58689594 + 0.0 * I, 0.58875264 + 0.0 * I,
        0.59058734 + 0.0 * I, 0.59239983 + 0.0 * I, 0.59418991 + 0.0 * I, 0.59595738 + 0.0 * I,
        0.59770206 + 0.0 * I, 0.59942374 + 0.0 * I, 0.60112223 + 0.0 * I, 0.60279734 + 0.0 * I,
        0.6044489 + 0.0 * I, 0.6060767 + 0.0 * I, 0.60768058 + 0.0 * I, 0.60926035 + 0.0 * I,
        0.61081583 + 0.0 * I, 0.61234686 + 0.0 * I, 0.61385324 + 0.0 * I, 0.61533483 + 0.0 * I,
        0.61679145 + 0.0 * I, 0.61822293 + 0.0 * I, 0.61962911 + 0.0 * I, 0.62100984 + 0.0 * I,
        0.62236495 + 0.0 * I, 0.6236943 + 0.0 * I, 0.62499772 + 0.0 * I, 0.62627508 + 0.0 * I,
        0.62752623 + 0.0 * I, 0.62875102 + 0.0 * I, 0.62994932 + 0.0 * I, 0.63112098 + 0.0 * I,
        0.63226588 + 0.0 * I, 0.63338388 + 0.0 * I, 0.63447485 + 0.0 * I, 0.63553866 + 0.0 * I,
        0.63657521 + 0.0 * I, 0.63758435 + 0.0 * I, 0.63856599 + 0.0 * I, 0.63952001 + 0.0 * I,
        0.64044628 + 0.0 * I, 0.64134472 + 0.0 * I, 0.64221521 + 0.0 * I, 0.64305766 + 0.0 * I,
        0.64387196 + 0.0 * I, 0.64465803 + 0.0 * I, 0.64541576 + 0.0 * I, 0.64614508 + 0.0 * I,
        0.64684589 + 0.0 * I, 0.64751812 + 0.0 * I, 0.64816169 + 0.0 * I, 0.64877652 + 0.0 * I,
        0.64936255 + 0.0 * I, 0.64991969 + 0.0 * I, 0.6504479 + 0.0 * I, 0.6509471 + 0.0 * I,
        0.65141724 + 0.0 * I, 0.65185826 + 0.0 * I, 0.65227011 + 0.0 * I, 0.65265275 + 0.0 * I,
        0.65300613 + 0.0 * I, 0.6533302 + 0.0 * I, 0.65362493 + 0.0 * I, 0.65389029 + 0.0 * I,
        0.65412624 + 0.0 * I, 0.65433276 + 0.0 * I, 0.65450982 + 0.0 * I, 0.65465741 + 0.0 * I,
        0.65477549 + 0.0 * I, 0.65486407 + 0.0 * I, 0.65492313 + 0.0 * I, 0.65495266 + 0.0 * I,
        0.65495266 + 0.0 * I, 0.65492313 + 0.0 * I, 0.65486407 + 0.0 * I, 0.65477549 + 0.0 * I,
        0.65465741 + 0.0 * I, 0.65450982 + 0.0 * I, 0.65433276 + 0.0 * I, 0.65412624 + 0.0 * I,
        0.65389029 + 0.0 * I, 0.65362493 + 0.0 * I, 0.6533302 + 0.0 * I, 0.65300613 + 0.0 * I,
        0.65265275 + 0.0 * I, 0.65227011 + 0.0 * I, 0.65185826 + 0.0 * I, 0.65141724 + 0.0 * I,
        0.6509471 + 0.0 * I, 0.6504479 + 0.0 * I, 0.64991969 + 0.0 * I, 0.64936255 + 0.0 * I,
        0.64877652 + 0.0 * I, 0.64816169 + 0.0 * I, 0.64751812 + 0.0 * I, 0.64684589 + 0.0 * I,
        0.64614508 + 0.0 * I, 0.64541576 + 0.0 * I, 0.64465803 + 0.0 * I, 0.64387196 + 0.0 * I,
        0.64305766 + 0.0 * I, 0.64221521 + 0.0 * I, 0.64134472 + 0.0 * I, 0.64044628 + 0.0 * I,
        0.63952001 + 0.0 * I, 0.63856599 + 0.0 * I, 0.63758435 + 0.0 * I, 0.63657521 + 0.0 * I,
        0.63553866 + 0.0 * I, 0.63447485 + 0.0 * I, 0.63338388 + 0.0 * I, 0.63226588 + 0.0 * I,
        0.63112098 + 0.0 * I, 0.62994932 + 0.0 * I, 0.62875102 + 0.0 * I, 0.62752623 + 0.0 * I,
        0.62627508 + 0.0 * I, 0.62499772 + 0.0 * I, 0.6236943 + 0.0 * I, 0.62236495 + 0.0 * I,
        0.62100984 + 0.0 * I, 0.61962911 + 0.0 * I, 0.61822293 + 0.0 * I, 0.61679145 + 0.0 * I,
        0.61533483 + 0.0 * I, 0.61385324 + 0.0 * I, 0.61234686 + 0.0 * I, 0.61081583 + 0.0 * I,
        0.60926035 + 0.0 * I, 0.60768058 + 0.0 * I, 0.6060767 + 0.0 * I, 0.6044489 + 0.0 * I,
        0.60279734 + 0.0 * I, 0.60112223 + 0.0 * I, 0.59942374 + 0.0 * I, 0.59770206 + 0.0 * I,
        0.59595738 + 0.0 * I, 0.59418991 + 0.0 * I, 0.59239983 + 0.0 * I, 0.59058734 + 0.0 * I,
        0.58875264 + 0.0 * I, 0.58689594 + 0.0 * I, 0.58501743 + 0.0 * I, 0.58311733 + 0.0 * I,
        0.58119584 + 0.0 * I, 0.57925317 + 0.0 * I, 0.57728954 + 0.0 * I, 0.57530516 + 0.0 * I,
        0.57330023 + 0.0 * I, 0.57127499 + 0.0 * I, 0.56922965 + 0.0 * I, 0.56716443 + 0.0 * I,
        0.56507955 + 0.0 * I, 0.56297523 + 0.0 * I, 0.56085171 + 0.0 * I, 0.55870921 + 0.0 * I,
        0.55654796 + 0.0 * I, 0.55436818 + 0.0 * I, 0.55217011 + 0.0 * I, 0.54995398 + 0.0 * I,
        0.54772003 + 0.0 * I, 0.5454685 + 0.0 * I, 0.5431996 + 0.0 * I, 0.5409136 + 0.0 * I,
        0.53861072 + 0.0 * I, 0.5362912 + 0.0 * I, 0.53395529 + 0.0 * I, 0.53160323 + 0.0 * I,
        0.52923526 + 0.0 * I, 0.52685163 + 0.0 * I, 0.52445258 + 0.0 * I, 0.52203835 + 0.0 * I,
        0.5196092 + 0.0 * I, 0.51716537 + 0.0 * I, 0.5147071 + 0.0 * I, 0.51223466 + 0.0 * I,
        0.50974829 + 0.0 * I, 0.50724823 + 0.0 * I, 0.50473474 + 0.0 * I, 0.50220808 + 0.0 * I,
        0.49966849 + 0.0 * I, 0.49711622 + 0.0 * I, 0.49455153 + 0.0 * I, 0.49197467 + 0.0 * I,
        0.4893859 + 0.0 * I, 0.48678547 + 0.0 * I, 0.48417363 + 0.0 * I, 0.48155063 + 0.0 * I,
        0.47891674 + 0.0 * I, 0.4762722 + 0.0 * I, 0.47361728 + 0.0 * I, 0.47095222 + 0.0 * I,
        0.46827728 + 0.0 * I, 0.46559272 + 0.0 * I, 0.46289878 + 0.0 * I, 0.46019573 + 0.0 * I,
        0.45748382 + 0.0 * I, 0.4547633 + 0.0 * I, 0.45203442 + 0.0 * I, 0.44929745 + 0.0 * I,
        0.44655263 + 0.0 * I, 0.44380022 + 0.0 * I, 0.44104046 + 0.0 * I, 0.43827362 + 0.0 * I,
        0.43549994 + 0.0 * I, 0.43271968 + 0.0 * I, 0.42993308 + 0.0 * I, 0.42714039 + 0.0 * I,
        0.42434187 + 0.0 * I, 0.42153777 + 0.0 * I, 0.41872833 + 0.0 * I, 0.4159138 + 0.0 * I,
        0.41309442 + 0.0 * I, 0.41027045 + 0.0 * I, 0.40744213 + 0.0 * I, 0.40460969 + 0.0 * I,
        0.4017734 + 0.0 * I, 0.39893348 + 0.0 * I, 0.39609019 + 0.0 * I, 0.39324375 + 0.0 * I,
        0.39039442 + 0.0 * I, 0.38754242 + 0.0 * I, 0.384688 + 0.0 * I, 0.3818314 + 0.0 * I,
        0.37897285 + 0.0 * I, 0.37611258 + 0.0 * I, 0.37325082 + 0.0 * I, 0.37038781 + 0.0 * I,
        0.36752378 + 0.0 * I, 0.36465896 + 0.0 * I, 0.36179358 + 0.0 * I, 0.35892786 + 0.0 * I,
        0.35606202 + 0.0 * I, 0.3531963 + 0.0 * I, 0.35033091 + 0.0 * I, 0.34746608 + 0.0 * I,
        0.34460202 + 0.0 * I, 0.34173895 + 0.0 * I, 0.3388771 + 0.0 * I, 0.33601666 + 0.0 * I,
        0.33315787 + 0.0 * I, 0.33030093 + 0.0 * I, 0.32744604 + 0.0 * I, 0.32459343 + 0.0 * I,
        0.32174329 + 0.0 * I, 0.31889583 + 0.0 * I, 0.31605126 + 0.0 * I, 0.31320977 + 0.0 * I,
        0.31037157 + 0.0 * I, 0.30753685 + 0.0 * I, 0.30470582 + 0.0 * I, 0.30187866 + 0.0 * I,
        0.29905558 + 0.0 * I, 0.29623675 + 0.0 * I, 0.29342238 + 0.0 * I, 0.29061265 + 0.0 * I,
        0.28780773 + 0.0 * I, 0.28500783 + 0.0 * I, 0.28221312 + 0.0 * I, 0.27942377 + 0.0 * I,
        0.27663997 + 0.0 * I, 0.2738619 + 0.0 * I, 0.27108973 + 0.0 * I, 0.26832362 + 0.0 * I,
        0.26556375 + 0.0 * I, 0.2628103 + 0.0 * I, 0.26006342 + 0.0 * I, 0.25732327 + 0.0 * I,
        0.25459003 + 0.0 * I, 0.25186385 + 0.0 * I, 0.24914488 + 0.0 * I, 0.2464333 + 0.0 * I,
        0.24372924 + 0.0 * I, 0.24103286 + 0.0 * I, 0.23834431 + 0.0 * I, 0.23566374 + 0.0 * I,
        0.23299129 + 0.0 * I, 0.23032712 + 0.0 * I, 0.22767135 + 0.0 * I, 0.22502412 + 0.0 * I,
        0.22238558 + 0.0 * I, 0.21975587 + 0.0 * I, 0.2171351 + 0.0 * I, 0.21452342 + 0.0 * I,
        0.21192095 + 0.0 * I, 0.20932782 + 0.0 * I, 0.20674415 + 0.0 * I, 0.20417007 + 0.0 * I,
        0.20160569 + 0.0 * I, 0.19905114 + 0.0 * I, 0.19650653 + 0.0 * I, 0.19397196 + 0.0 * I,
        0.19144757 + 0.0 * I, 0.18893344 + 0.0 * I, 0.1864297 + 0.0 * I, 0.18393645 + 0.0 * I,
        0.18145378 + 0.0 * I, 0.1789818 + 0.0 * I, 0.17652061 + 0.0 * I, 0.17407031 + 0.0 * I,
        0.17163099 + 0.0 * I, 0.16920274 + 0.0 * I, 0.16678565 + 0.0 * I, 0.16437981 + 0.0 * I,
        0.16198531 + 0.0 * I, 0.15960223 + 0.0 * I, 0.15723065 + 0.0 * I, 0.15487065 + 0.0 * I,
        0.15252232 + 0.0 * I, 0.15018572 + 0.0 * I, 0.14786093 + 0.0 * I, 0.14554802 + 0.0 * I,
        0.14324706 + 0.0 * I, 0.14095811 + 0.0 * I, 0.13868125 + 0.0 * I, 0.13641654 + 0.0 * I,
        0.13416403 + 0.0 * I, 0.13192379 + 0.0 * I, 0.12969588 + 0.0 * I, 0.12748034 + 0.0 * I,
        0.12527724 + 0.0 * I, 0.12308662 + 0.0 * I, 0.12090853 + 0.0 * I, 0.11874303 + 0.0 * I,
        0.11659015 + 0.0 * I, 0.11444995 + 0.0 * I, 0.11232246 + 0.0 * I, 0.11020772 + 0.0 * I,
        0.10810576 + 0.0 * I, 0.10601664 + 0.0 * I, 0.10394038 + 0.0 * I, 0.10187701 + 0.0 * I,
        0.09982656 + 0.0 * I, 0.09778907 + 0.0 * I, 0.09576455 + 0.0 * I, 0.09375304 + 0.0 * I,
        0.09175456 + 0.0 * I, 0.08976913 + 0.0 * I, 0.08779677 + 0.0 * I, 0.08583749 + 0.0 * I,
        0.08389132 + 0.0 * I, 0.08195827 + 0.0 * I, 0.08003836 + 0.0 * I, 0.07813158 + 0.0 * I,
        0.07623796 + 0.0 * I, 0.0743575 + 0.0 * I, 0.07249021 + 0.0 * I, 0.07063609 + 0.0 * I,
        0.06879515 + 0.0 * I, 0.06696739 + 0.0 * I, 0.0651528 + 0.0 * I, 0.06335139 + 0.0 * I,
        0.06156316 + 0.0 * I, 0.05978809 + 0.0 * I, 0.05802619 + 0.0 * I, 0.05627745 + 0.0 * I,
        0.05454185 + 0.0 * I, 0.05281939 + 0.0 * I, 0.05111006 + 0.0 * I, 0.04941384 + 0.0 * I,
        0.04773072 + 0.0 * I, 0.04606068 + 0.0 * I, 0.04440371 + 0.0 * I, 0.04275978 + 0.0 * I,
        0.04112888 + 0.0 * I, 0.03951099 + 0.0 * I, 0.03790609 + 0.0 * I, 0.03631414 + 0.0 * I,
        0.03473513 + 0.0 * I, 0.03316902 + 0.0 * I, 0.0316158 + 0.0 * I, 0.03007544 + 0.0 * I,
        0.0285479 + 0.0 * I, 0.02703315 + 0.0 * I, 0.02553116 + 0.0 * I, 0.0240419 + 0.0 * I,
        0.02256534 + 0.0 * I, 0.02110143 + 0.0 * I, 0.01965015 + 0.0 * I, 0.01821146 + 0.0 * I,
        0.01678531 + 0.0 * I, 0.01537167 + 0.0 * I, 0.0139705 + 0.0 * I, 0.01258175 + 0.0 * I,
        0.01120539 + 0.0 * I, 0.00984137 + 0.0 * I, 0.00848964 + 0.0 * I, 0.00715017 + 0.0 * I,
        0.00582291 + 0.0 * I, 0.0045078 + 0.0 * I, 0.00320481 + 0.0 * I, 0.00191388 + 0.0 * I};
} // namespace

TEST(PulseGenTester, testDrag) 
{
    // Reference Drag pulse
    //{"amp":[0.6549563501371142,0.0],"beta":-4.716276394709174,"duration":640,"sigma":160}
    const std::complex<double> amp { 0.6549563501371142, 0.0 };
    const int sigma = 160;
    const double beta = -4.716276394709174;
    const auto dragPulse = QuaC::Drag(640, amp, sigma, beta, true, QuaC::SamplerType::Midpoint);
   
    for (size_t i = 0; i < dragPulse.size(); ++i)
    {
        EXPECT_NEAR(std::abs(dragPulse[i] - REF_DRAG_PULSE[i]), 0.0, 1e-6);
    }
}

TEST(PulseGenTester, testGaussian)
{
    // Reference Gaussian pulse
    //{"amp":[0.6549563501371142,0.0],"duration":640,"sigma":160}
    const std::complex<double> amp{0.6549563501371142, 0.0};
    const int sigma = 160;
    const auto gaussianPulse = QuaC::Drag(640, amp, sigma, 0.0, true, QuaC::SamplerType::Midpoint);

    for (size_t i = 0; i < gaussianPulse.size(); ++i)
    {
        EXPECT_NEAR(std::abs(gaussianPulse[i] - REF_GAUSSIAN_PULSE[i]), 0.0, 1e-6);
    }
}

int main(int argc, char **argv) 
{
  ::testing::InitGoogleTest(&argc, argv);
  auto ret = RUN_ALL_TESTS();
  return ret;
}